# Fix CVE-2020-15228 (set-env, add-path in Github-Actions)

This script changes lines in your github action file.

You give it a directory name, and it searches for all files with the ".sh" extension.

It recognizes these lines:

```
echo ::set-env name=FOO_BAR::$FOO_BAR
echo ::set-env name=FOO_BAR::${FOO_BAR}
echo "::set-env name=FOO_BAR::$FOO_BAR"
echo "::set-env name=FOO_BAR::${FOO_BAR}"
```

All get rewrites to 
```
echo "FOO_BAR=$FOO_BAR" >> $GITHUB_ENV
```

# Run


```
curl -sSL https://raw.githubusercontent.com/guettli/fix-CVE-2020-15228/main/fix_CVE_2020_15228.py | python3 - DIRECTORY
```

Please give this project a "star" if it was usefull to you.


# Patches

If you want to modify this script, you can start like this:

```
# Create a new virtual environment
python3 -m venv fix-CVE-2020-15228

cd fix-CVE-2020-15228

. bin/activate

# Install the source code via ssh
pip install -e git+ssh://git@github.com/guettli/fix-CVE-2020-15228.git#egg=fix-CVE-2020-15228

$EDITOR src/fix-cve-2020-15228/fix_CVE_2020_15228.py
```

Patches are welcome
